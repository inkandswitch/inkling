{
  "version": 3,
  "sources": ["/Users/admin/Work/Inkling/Prototypes/OldInputSystem/src/app/NativeEvents.ts"],
  "sourcesContent": ["import { Position } from '../lib/types';\n\nexport type Event = PencilEvent | FingerEvent;\nexport type EventType = Event['type'];\nexport type EventState = 'began' | 'moved' | 'cancelled' | 'ended';\nexport type TouchId = string;\n\ninterface AEvent {\n  state: EventState;\n  id: TouchId;\n  position: Position;\n  timestamp: number;\n  radius: number;\n}\n\nexport interface PencilEvent extends AEvent {\n  type: 'pencil';\n  pressure: number;\n  altitude: number;\n  azimuth: number;\n}\n\nexport interface FingerEvent extends AEvent {\n  type: 'finger';\n}\n\n// If we fixed the following inconsistencies, we could delete most of nativeEvent:\n// \u2022 .type: \"touch\" -> .type: \"finger\"\n// \u2022 .type: \"stylus\" is deprecated in favor of .type: \"pencil\"\n// \u2022 .x and .y -> position: { x, y }\n// \u2022 .force -> .pressure\n\ntype TouchPoint = {\n  type: 'pencil' | 'touch' | 'stylus';\n  altitude: number;\n  azimuth: number;\n  force: number;\n  radius: number;\n  timestamp: number;\n  x: number;\n  y: number;\n};\n\nexport default class Events {\n  private events: Event[] = [];\n\n  constructor() {\n    this.setupNativeEventHandler();\n  }\n\n  clear() {\n    this.events = [];\n  }\n\n  find(\n    type: 'pencil',\n    state: EventState,\n    id?: TouchId\n  ): PencilEvent | undefined;\n  find(\n    type: 'finger',\n    state: EventState,\n    id?: TouchId\n  ): FingerEvent | undefined;\n  find(type: EventType, state: EventState, id?: TouchId) {\n    return this.events.find(\n      e => e.type === type && e.state === state && (!id || e.id === id)\n    );\n  }\n\n  findAll(type: 'pencil', state: EventState, id?: TouchId): PencilEvent[];\n  findAll(type: 'finger', state: EventState, id?: TouchId): FingerEvent[];\n  findAll(type: EventType, state: EventState, id?: TouchId) {\n    return this.events.filter(\n      e => e.type === type && e.state === state && (!id || e.id === id)\n    );\n  }\n\n  findLast(\n    type: 'pencil',\n    state: EventState,\n    id?: TouchId\n  ): PencilEvent | undefined;\n  findLast(\n    type: 'finger',\n    state: EventState,\n    id?: TouchId\n  ): FingerEvent | undefined;\n  findLast(type: EventType, state: EventState, id?: TouchId) {\n    return this.events.findLast(\n      e => e.type === type && e.state === state && (!id || e.id === id)\n    );\n  }\n\n  private setupNativeEventHandler() {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    (window as any).nativeEvent = (\n      state: EventState,\n      touches: Record<TouchId, TouchPoint[]>\n    ) => {\n      for (const id in touches) {\n        for (const point of touches[id]) {\n          const { type, timestamp, radius, force, altitude, azimuth, x, y } =\n            point;\n\n          const sharedProperties = {\n            state,\n            id,\n            position: { x, y },\n            timestamp,\n            radius,\n          };\n\n          const event: Event =\n            type === 'touch'\n              ? {\n                  type: 'finger',\n                  ...sharedProperties,\n                }\n              : {\n                  type: 'pencil',\n                  pressure: force,\n                  altitude,\n                  azimuth,\n                  ...sharedProperties,\n                };\n\n          this.events.push(event);\n        }\n      }\n    };\n  }\n}\n"],
  "mappings": "AA2CA,4BAA4B;AAAA,EAG1B,cAAc;AAFN,kBAAkB;AAGxB,SAAK;AAAA;AAAA,EAGP,QAAQ;AACN,SAAK,SAAS;AAAA;AAAA,EAahB,KAAK,MAAiB,OAAmB,IAAc;AACrD,WAAO,KAAK,OAAO,KACjB,OAAK,EAAE,SAAS,QAAQ,EAAE,UAAU,SAAU,EAAC,MAAM,EAAE,OAAO;AAAA;AAAA,EAMlE,QAAQ,MAAiB,OAAmB,IAAc;AACxD,WAAO,KAAK,OAAO,OACjB,OAAK,EAAE,SAAS,QAAQ,EAAE,UAAU,SAAU,EAAC,MAAM,EAAE,OAAO;AAAA;AAAA,EAclE,SAAS,MAAiB,OAAmB,IAAc;AACzD,WAAO,KAAK,OAAO,SACjB,OAAK,EAAE,SAAS,QAAQ,EAAE,UAAU,SAAU,EAAC,MAAM,EAAE,OAAO;AAAA;AAAA,EAI1D,0BAA0B;AAEhC,IAAC,OAAe,cAAc,CAC5B,OACA,YACG;AACH,iBAAW,MAAM,SAAS;AACxB,mBAAW,SAAS,QAAQ,KAAK;AAC/B,gBAAM,CAAE,MAAM,WAAW,QAAQ,OAAO,UAAU,SAAS,GAAG,KAC5D;AAEF,gBAAM,mBAAmB;AAAA,YACvB;AAAA,YACA;AAAA,YACA,UAAU,CAAE,GAAG;AAAA,YACf;AAAA,YACA;AAAA;AAGF,gBAAM,QACJ,SAAS,UACL;AAAA,YACE,MAAM;AAAA,eACH;AAAA,cAEL;AAAA,YACE,MAAM;AAAA,YACN,UAAU;AAAA,YACV;AAAA,YACA;AAAA,eACG;AAAA;AAGX,eAAK,OAAO,KAAK;AAAA;AAAA;AAAA;AAAA;AAAA;",
  "names": []
}
